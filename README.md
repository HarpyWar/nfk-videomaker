NFK Demo Maker
=============

Автоматизирует создание видео из демок для игры [Need For Kill](http://needforkill.ru). 

Набор из трех утилит для развертывания на выделенном сервере (требуется видеокарта для запуска игры). Заложена возможность параллельного запуска на разных серверах с передачей результатов на сайт статистики. Для этого достаточно изменить `appid` в [config.xml](https://github.com/HarpyWar/nfk-demomaker/blob/master/Helper/config.xml).


![](http://i.imgur.com/xgDdKZf.png)

Проект запущен на выделенном сервере и продюсирует видео от новых сыгранных игр на http://www.youtube.com/user/needforkilldemo

ndm2video.exe
--
*Создает видео файл из демки. Консольная программа, может работать отдельно с параметрами запуска через командную строку.*
- в autoexec.cfg добавляются команды в числе которых avi_start
- запускается nfk.exe
- при появлении первой картинки в basenfk, меняется следуемый игрок путем посыла нескольких команд nextplayer
- здесь же запускается утилита ffmpeg с захватом видео из окна игры
- по окончании проигрывания демки (время задается в параметрах запуска) nfk.exe убивается, а за ним и ffmpeg закрывается сам с готовым видео файлом
- запускается снова ffmpeg для соединения видео файла заставки с созданным видео демки.
- после через ffmpeg запускается кодирование окончательного варианта с оптимальным качеством для закачки на youtube

ndmscheduler.exe
--
*Запрашивает информацию о демке из API сайта статистики, скачивает файл демки запускает `ndm2video.exe` для создания из нее видео файла. При запуске не создает окон, предназначена для запуска по планировщику (раз в минуту с запретом дублирующего процесса).*
- скачивает демку с сайта статистики, для которой еще не создано видео
- запускает ndm2video с необходимыми параметрами столько раз, сколько игроков в демке - по одному видео от первого лица для каждого игрока 
- при успешном создании всех видео для всех игроков создает json файл с информацией о демке

ndmuploader.exe
--
*Работает отдельно, загружает видео на Youtube. При запуске не создает окон, предназначена для запуска по планировщику (раз в минуту с запретом дублирующего процесса).*
- мониторит json файлы, если такие есть, читает из них информацию о демке, имена видео файлов для закачки на YouTube
- загружает файл демки на файловый хостинг mega.co.nz
- загружает видео файлы на YouTube, в описание вставляется информация о демке, ссылка на сайт статистики и ссылка на скачивание файла демки с mega.co.nz 

- по окончании загрузки посылает YouTube ссылки на сайт статистики
